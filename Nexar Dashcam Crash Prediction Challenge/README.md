# 🚗 Nexar Dashcam Crash Prediction Challenge

<aside>
💡

대회: https://www.kaggle.com/competitions/nexar-collision-prediction/code

관련 논문: https://arxiv.org/pdf/2503.03848

참고 노트북: https://www.kaggle.com/code/fernandosr85/dashcam-collision-prediction-project

https://www.kaggle.com/code/sandiledesmondmfazi/nexar-dcp-challenge-baseline

참고 디스커션: https://www.kaggle.com/competitions/nexar-collision-prediction/discussion/564581

</aside>

### **📌 대회 정리**

| 주제 | 대시캠 영상을 활용한 사고 조기 예측 모델 개발 |
| --- | --- |
| 주최 | Nexar |
| 총 상금  | 총 $5,000 |
| 문제 유형  | 분류 (Classification) / 영상 기반 조기 예측 |
| 데이터 타입  | 도로 주행 영상 (1280×720, 30fps) |
| 평가 지표 | Mean Average Precision (mAP) at 500ms, 1000ms, 1500ms before accident |
| 대회 참가 팀 | 약 166여  |

# 1️⃣ 대회 개요

## 1. 대회 목표

- 자율주행 및 첨단 운전자 보조 시스템(ADAS)을 위한 사고 예측 모델 개발
- 사고 발생 이전에 위험 상황을 감지해 운전자가 충분한 대응 시간을 확보할 수 있도록 하는 것이 핵심

## 2. 데이터 소개

### 1) 비디오 유형

| 유형 | 설명 | 부가 정보 |
| --- | --- | --- |
| ✅ Positive | 실제 사고 또는 near-miss | `time_of_event`, `time_of_alert` 제공  |
| ❌ Negative | 정상 주행, 위험 상황 없음 | 시간 정보 없음  |

### 2) 데이터 구성 요약

📌 해상도: 1280 X 720 (30 FPS) 

| 구분 | 개수 | 길이 | 비고 |
| --- | --- | --- | --- |
| Train | 1,500개 | 약 40초 | Positive : Negative = 1:1 |
| Test | 1,344개 | 약 10초 | 리더보드용 / 최종 평가용 각 절반 |

### 3) 테스트 데이터 특징

- 영상은 사고 발생 전까지만 포함
- 종료 시점은 아래 중 하나
    - **사고 1500ms 전**
    - **사고 1000ms 전**
    - **사고 500ms 전**
- 실제 사고 시점은 공개되지 않음
- 모델은 각 영상에 대해 사고 가능성 score (0~1) 출력

## 3. 평가 지표

### 1) Time to Accident (TTA)

- 사고 시점(`time_of_event`)과 사고를 예측할 수 있었던 최초 시점(`time_of_alert`) 간의 간격
- 테스트셋에서는 사고 발생 전 **500ms / 1000ms / 1500ms** 시점에서의 예측 성능을 평가

### 2) 평가 절차 요약

1. 각 TTA 구간별로 Precision-Recall (PR) 곡선을 작성
2. PR 곡선을 바탕으로 Average Precision (AP) 값을 계산
3. 최종 점수는 3개 TTA(500ms, 1000ms, 1500ms)에 대한 AP의 평균으로 산출

🔑 이 방식은 얼마나 조기에, 그리고 정확하게 사고를 예측했는지를 종합적으로 평가

### 3) Precision & Recall

| 개념 | 설명 | 공식 |
| --- | --- | --- |
| Precision (정밀도) | 예측한 Positive 중 실제로 Positive인 비율 | `TP / (TP + FP)` |
| Recall (재현율) | 실제 Positive 중에서 올바르게 예측한 비율 | `TP / (TP + FN)`  |

### 4) Anticipation Time (조기 예측 능력)

- 모델이 충돌을 얼마나 일찍 예측했는가를 평가하는 요소
- 평가 기준은 세 가지 시간 간격으로 나뉜다
    - 500ms 전
    - 1000ms 전
    - 1500ms 전
- 더 이른 시점에서 정확히 예측할수록 높은 점수를 받을 수 있다

---

# 📘 논문 요약

## 🔍 논문 목적

- 실제 도로 환경에서 교통 사고 예측을 위한 공개 데이터셋 및 챌린지 제안
- 자율주행 및 ADAS 시스템의 조기 사고 예측 연구를 촉진하기 위한 목표
- 모델이 충돌 전 특정 시점(`alert_time`)부터 사고를 예측할 수 있도록 설계됨

## 🎥 데이터셋 개요

| 데이터 수 | 총 1,500개 영상 (40초 분량) |
| --- | --- |
| 구성  | Positive (400 Collision + 350 Near-miss) / Negative (750 Normal) |
| 해상도 및 FPS | 1280×720, 30 FPS |
| 수집 방식 | Nexar 대시캠의 급제동 / 급가속 감지 시 자동 녹화 |
| 어노테이션 | `event_time` (사고 시점), `alert_time` (조기 인지 가능 시점) 포함 |
| 특성 | 다양한 조명/날씨/도로 환경 + 영상 왜곡 포함 (예: 빛 번짐, 블러 등) |
| 프라이버시 | 번호판/얼굴/음성 제거 등 엄격한 익명화 조치 적용 |

## 🕒 영상 구간 정의

![image.png](image.png)

1. Before Accident: 영상 시작 ~ `alert_time`
2. Alert Interval: `alert_time` ~ `event_time`
3. After Accident: `event_time` 이후

<aside>
📌

평균 `alert_to_event` 간격: 약 1.6초, 최대 4.5초

→ 사람의 반응 속도를 고려하면 사고 직전 예측은 자율주행에 특화된 난제

</aside>

## 🧪 챌린지 및 평가 방식

### 🎯 과제 목표

: 모델이 짧은 영상(약 10초)을 보고 사고가 일어날 가능성을 조기에 예측하는 것

- 입력: 영상 전체
- 출력: 사고 가능성 score (0~1 실수값)

### 🧪 테스트셋 구성

- 총 1,344개 영상
- `Positive` 케이스는 event 시점 기준으로 3개 TTA 버전(500ms/1000ms/1500ms)으로 분할
- `Negative`는 유사 분포의 fake time 사용
    
    ### 📌 왜 fake time이 필요한가?
    
    대회에서 모델은 **Positive인지 Negative인지 구분하는 확률 점수(0~1)를 출력**
    
    그런데 테스트셋에는 Positive 예시가 `time_of_event`, `time_of_alert` 기준으로 **사고 직전까지만 자른 영상**이 들어가 있다
    
    예를 들면,
    
    - 사고 영상은 40초짜리 영상 중, 사고 시점 1500ms 전에 끝나는 **10초짜리 부분만** 잘라서 제공
    - 이러면 모델은 "끝나는 타이밍" 자체로도 힌트를 얻을 수 있어 → 편향 생김
    
    👉 **그래서 Negative도 Positive처럼 보이게 맞춰줘야 함**
    
    ---
    
    ### 📍 구체적인 예시
    
    1. **Positive 영상 (사고 있음)**:
        - 항상 **사고 발생 직전까지**로 잘려 있다
        - 예: 사고 1500ms 전, 즉 **마지막 프레임이 항상 위험 직전**
    2. **Negative 영상 (사고 없음)**:
        - 만약 그냥 10초 랜덤 영상이라면, **사고로 이어질 듯한 위기 장면 없이 끝남**
    
    👉 이렇게 되면, 모델이 진짜 사고 여부를 보지 않고
    
    - **끝이 뭔가 급박하다 → Positive**
    - **끝이 너무 평온하고 느긋하다 → Negative**
    
    라고 판단하게 된다
    
    ---
    
    ### 🎯 어떤 편향(Bias)이 생길 수 있을까?
    
    1. **"영상의 마지막 몇 프레임"만 보고 판단하는 모델이 될 위험**
    
    - 마지막 1~2초에만 집중해서 예측 → 실제로는 전혀 사고를 인식한 게 아님
    - 이런 모델은 "겉보기에만 충실"하고, 실제 사고 예측력은 없음
    
    2. **실제 응용에서 무용지물**
    
    - 실제 서비스에서는 "이게 언제 끝날지" 모르는 상태에서 판단해야 함
    - 영상 종료 시점이 힌트가 되면, 테스트셋에서는 잘 작동해도 실전에서는 사용 못함
    
    ---
    
    ### 💡 시간적으로 영상이 끝나는 위치(구조) 때문에 생기는 편향
    
    → 모델이 프레임을 직접 보고 ‘위험해 보인다’고 판단하기보다는, 영상이 어디서 끝나는지를 은근슬쩍 학습해버린다
    
    예를 들어,
    
    - 영상이 “이상하게 10초 딱 되면 끊긴다” → 이건 사고 영상이다!
    - 영상이 “그냥 아무 일 없이 10초 흐르다가 끝나네” → 이건 정상 주행이다!
    
    <aside>
    
    따라서 Negative 영상도 마치 Positive처럼 사고 직전에서 잘린 것처럼 보이게 일부러 구조를 맞춤
    
    </aside>
    
    ---
    
    ### 🧪 어떻게 fake time을 설정하나?
    
    - Negative 예시(사고 없는 영상)에도 **가짜 event time / alert time**을 만들어서
        
        Positive처럼 “사고 직전까지만 잘린 영상처럼 보이게” 구성
        
    - 이 때, **진짜 사고가 없기 때문에**, time 값은 랜덤하게 생성된다
        - 평균적으로 영상 길이의 **중간쯤** (`video_length / 2`)에 event가 있다고 가정
        - 여기에 Gaussian noise (정규분포 노이즈)를 추가해서 다양하게 분포를 만들어냄
    - alert time도 비슷한 분포를 따르도록 **fake alert time**을 생성
    
    ---
    
    ### ✅ 그래서 어떻게 해결하나?
    
    - **Negative 영상도 Positive처럼 보이게 꾸며준다**
        
        → 종료 시점이 사고 직전인 것처럼 잘라버리는 것
        
    - 즉, **Negative도 Positive처럼 “중간에 갑자기 끝나게” 만들어**
        
        → 모델은 더 이상 종료 패턴만으로 구분할 수 없음
        
    
    ---
    
- 평가용 데이터셋은 공개/비공개 절반씩 구성

## 📊 평가 지표

| 평가 항목 | 설명 |
| --- | --- |
| AP (Average Precision) | 각 TTA 구간별 Precision-Recall 곡선 아래 면적 |
| mAP | `AP500`, `AP1000`, `AP1500`의 평균 |
| 특징 | 정확도 + 조기 예측 능력을 동시에 평가 |

⛑️ TTA가 길수록 더 어려운 예측이지만, 더 높은 보상을 받을 수 있음

## 💡 주요 기여 (Contributions)

- 새로운 고난이도 실제 환경 기반 사고 예측 데이터셋 공개
- 다양한 날씨, 조명, 도로 조건 포함  + 실시간 판단이 어려운 단시간 이벤트 다수 포함
- 어노테이션 신뢰도 확보를 위해 복수 주석자 기반 통계적 처리
- Kaggle 챌린지를 통해 표준화된 벤치마크 환경 제공
- 인간의 반응 속도를 넘어서는 사고 예측까지 고려 → 자율주행 연구에 특화된 구성

## 🚀 향후 연구 방향 (Future Directions)

- 데이터셋 확장: 더 다양한 지역/교통 시나리오 반영
- 추가 정보 수집: 차량 유형, 운전자 행동, 도로 인프라 등
- 복잡한 상호작용/극한 환경 포함 → 완전한 사고 예측 플랫폼으로 발전 가

---

https://www.kaggle.com/competitions/nexar-collision-prediction/discussion/564581

# 🚗 **Crash Prediction Competition 해결 전략**

## 1️⃣ 데이터 전처리 및 EDA

### 1) CSV 및 영상 분석

- 메타데이터 활용: `time_of_event`, `time_of_alert` 정보를 통해 사고 타이밍 파악
- 주요 프레임 추출: 대부분의 충돌이 영상 중반에 발생 (~40초), 이 구간에 집중
- 영상 해상도 표준화: 1280×720 해상도로 맞추고, 밝기 조정
- 공간적 크롭 및 샘플링: 사고 전의 프레임을 선택하고, 차량 주위로 크롭

### 2) 정규화 및 증강

- 시간적 샘플링: 충돌 이벤트 직접 프레임을 선택하여 모델에 제공
- 공간적 증강: 랜덤 회전, 스케일링, 이동 등 다양한 기법을 적용

## 2️⃣ 모델 아키텍처

### **1) 3D CNN Approach**

- NFL 해결법 참조: 3D CNN (예: ResNet50-irCSN)을 사용하여 공간-시간 특성을 추출
- 멀티뷰 입력: 여러 대시캠 각도 활용 시 모델 성능 향상

### 2) Transformer 및 혼합 모델

- CNN + Transformer 결합: CNN으로 추출한 특성에 Transformer 레이어를 추가해 긴 시간적 의존성을 캡처
- 하이브리드 아키텍처: CNN + RNN/Transformer 결합 방식 실험

### 3) 광학 흐름 및 모션 특징

- 광학 흐름: 차량의 동적 움직임을 잘 포착하고, 충돌 예측에 활용

## 3️⃣ 데이터 증강 및 정규화

### 1) 시간적 증강

- 랜덤 타임워핑: 시간 왜곡 및 프레임 드랍을 통해 다양한 충돌 타이밍을 시뮬레이션

### 2) 공간적 증강

- Affine 변환: 회전, 스케일링, 이동 등 다양한 공간적 증강
- 밝기/대비 조정: 날씨나 조명에 따른 데이터 다양성 보장

### 3) 정규화 기법

- Dropout, Stochastic Depth, AWP(Adversarial Weight Perturbation) 등을 이용해 과적합 방지

## 4️⃣ 후처리 및 앙상블 기법

### 1) 시간적 스무딩

- 슬라이딩 윈도우 필터링 또는 시간적 NMS (Non-Maximum Suppression)를 적용해 예측을 부드럽게 처리

### 2) 앙상블

- 여러 모델(예: 3D CNN, Transformer 기반 모델)을 단순 평균 또는 XGBoost 기반 후처리로 결합하여 예측 성능 향상

## 5️⃣ 이전 대회에서의 영감

### 1) NFL 대회 해결법

- 다중 뷰 처리 및 추적 데이터 활용: 여러 대시캠 시각을 융합하여 예측 성능 강화

### 2) YouTube-8M 전략

- 후보 생성 및 세그먼트 레벨 재정렬 기법을 이용해 충돌 이벤트를 조기에 로컬라이징할 수 있음

### 3) ASL 손말 인식

- 정규화, 랜드마크 추출, 창의적인 증강 (예: CutMix, Time Masking) 기법을 도입하여 효과적인 특성 추출

## 6️⃣ 결론: 최적의 모델 구축을 위한 핵심 포인트

- 정확한 시간적 위치 파악이 중요
- 강력한 데이터 증강 및 정규화로 모델의 강건성 강화
- 혼합된 공간-시간 모델을 통해 보다 정교한 예측
- 앙상블 기법을 통한 예측 성능 극대화
